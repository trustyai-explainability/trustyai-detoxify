# TrustyAI-HAP
Algorithms and tools for detecting and fixing hate speech, abuse and PII disclosure (_HAP_) in text generated by Large Language Models (_LLMs_).

## T-MaRCo

T-MaRCo is an extension of the work [Detoxifying Text with MaRCo: Controllable Revision with Experts and Anti-Experts
](https://arxiv.org/abs/2212.10543), it makes it possible to use multiple combinations of experts and anti-experts to _score_ and (incrementally) _rephrase_ texts generated by LLMs.

How to use T-MaRCo:
```python
from trustyai.hap import TMaRCo

# instantiate T-MaRCo
tmarco = TMaRCo(expert_weights=[-1, 2])

# load pretrained anti-expert and expert models
tmarco.load_models(["trustyai/gminus", "trustyai/gplus"])

# pick up some text generated by a LLM
text = "White men can't jump"

# generate T-MaRCo disagreement scores
scores = tmarco.score(text)

# mask tokens having high disagreement scores
masked_text = tmarco.mask(text, scores=scores)

# rephrase masked tokens
rephrased = tmarco.rephrase(text, masked_text)

# incrementally rephrase masked tokens
inc_rephrased = tmarco.rephrase_incrementally(text)
```

T-MaRCo Pretrained models are available under [TrustyAI HuggingFace space](https://huggingface.co/trustyai) at https://huggingface.co/trustyai/gminus and https://huggingface.co/trustyai/gplus.